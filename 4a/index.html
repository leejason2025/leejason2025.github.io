<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS 180 Project 4a: Image Warping and Homographies</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap');

        body {
            font-family: 'Raleway', sans-serif;
            margin: 2%;
            padding: 0 5%; 
            text-align: center;
            background-color: #E7E9F0;
            color: #051747;
        }

        .title-block {
            background-color: #081F62; 
            color: #E7E9F0;
            padding: 4% 2%; 
            margin-bottom: 3%;
            text-align: center;
        }

        h1 {
            font-size: 2.7em; 
            margin-bottom: 1%;
        }

        h2 {
            font-size: 2.2em;
            margin-bottom: 1%;
        }

        h3 {
            font-size: 1.8em;
        }

        section h2 {
            font-size: 1.8em; 
            margin-bottom: 2%;
            margin-top: 5%; 
            position: relative;
        }

        section h2::after {
            content: '';
            display: block;
            width: 10%;
            height: 3px;
            background-color: #081F62; 
            margin: 1% auto; 
        }

        section {
            margin-bottom: 3%;
        }

        .image-item {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .image-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 7px;
            justify-items: center;
        }
        
        img {
            max-width: 100%;
            width: 400px;
            height: auto;
            border: 5px solid #535F80;
        }

        p {
            text-align: left;
            margin-bottom: 2%;
            font-size: 1.1em;
            line-height: 1.6em; 
        }

        /* Specific grid adjustments for each section */
        #collecting-pictures .image-container {
            grid-template-columns: repeat(2, 1fr);
        }

        #image-rectification .image-container {
            grid-template-columns: repeat(2, 1fr);
        }

        #recover-homographies .image-container, 
        #blending-mosaic .image-container,
        #warping-images .image-container {
            grid-template-columns: 1fr;
        }

        #recover-homographies img,
        #warping-images img,
        #blending-mosaic img {
            width: 800px; /* Adjust long image width */
        }
    </style>
</head>
<body>
    <div class="title-block">
        <h1>CS 180 Project 4a: Image Warping and Homographies</h1>
        <h2>Homography and Image Warping</h2>
        <h3>Jason Lee</h3>
    </div>
    
    <section id="collecting-pictures">
        <h2>Collecting Pictures</h2>
        <p>
            In the first stage of the project, I collected two pictures of Southside Berkeley 
            from slightly different perspectives. These images were chosen to capture enough 
            variation for the subsequent alignment process. To prepare for image warping, I 
            identified and defined 12 key correspondence points between the two photos, ensuring 
            that important landmarks were consistently mapped across both images, which would 
            facilitate accurate homography recovery and seamless image blending later in the project.
        </p>
        <div class="image-container">
            <div class="image-item">
                <img src="media/leftp.jpg" alt="Image 1">
                <p>Left Image</p>
            </div>
            <div class="image-item">
                <img src="media/rightp.jpg" alt="Image 2">
                <p>Right Image</p>
            </div>
        </div>
    </section>

    <section id="recover-homographies">
        <h2>Recover Homographies</h2>
        <p>
            To align the images, I recovered the homographies by matching corresponding points between the images. 
            The homography matrix allows transforming one image to align with the others by estimating how 
            the plane of the second image can be transformed into the first. Here is the result of applying 
            the recovered homography to align one image with the other.
        </p>
        <div class="image-container">
            <div class="image-item">
                <img src="media/homography_result.jpg" alt="Homography Alignment">
                <p>Homography Alignment Result</p>
            </div>
        </div>
    </section>

    <section id="warping-images">
        <h2>Warping Images</h2>
        <p>
            Next I implemented a function warpImage that applies a homography transformation to warp an image onto a new plane.
            The function takes in an image, a homography matrix, and an output size for the resulting warped image. Inside the function,
            I calculated the inverse of the homography matrix to map each pixel from the output image back to the original image 
            coordinates. For every pixel in the output, I used the inverse homography to find its corresponding position 
            in the original image, then sampled the pixel value from that position if it was within the bounds of the 
            original image.
        <div class="image-container">
            <div class="image-item">
                <img src="media/right.jpg" alt="Warped Image">
                <p>Original Image</p>
            </div>
            <div class="image-item">
                <img src="media/right_warped.jpg" alt="Warped Image">
                <p>Warped Image</p>
            </div>
        </div>
    </section>

    <section id="image-rectification">
        <h2>Image Rectification</h2>
        <p>
            To test the homography and image warping functions, I took a skewed picture of a painting I recently completed and rectified it. 
            To do this, I chose the four corners of the painting and also using a blank image i chose the four corners as the set of points. 
            I then found the homography matrix and used it to warp the skewed painting to a rectangle.
        </p>
        <div class="image-container">
            <div class="image-item">
                <img src="media/paint.jpg" alt="Original Image">
                <p>Original Image</p>
            </div>
            <div class="image-item">
                <img src="media/paint_warped.jpg" alt="Rectified Image">
                <p>Rectified Image</p>
            </div>
        </div>
    </section>

    <section id="blending-mosaic">
        <h2>Blending Mosaic</h2>
        <p>
            In the final step, I blended the warped images to create a mosaic. By carefully blending the overlapping regions, 
            I created a smooth transition between the images, producing a visually coherent result. Below is the completed mosaic.
        </p>
        <div class="image-container">
            <div class="image-item">
                <img src="media/mosaic.jpg" alt="Blended Mosaic">
                <p>Blended Mosaic</p>
            </div>
        </div>
    </section>
</body>
</html>
